# Итоги работы

## Что сделали
- Провели очистку и преобразование данных: убрали дубликаты, спарсили числовые признаки из строк (`mileage/engine/max_power/torque`), выделили `brand/model` из `name`, заполнили пропуски медианами/модой, привели типы, добавили бизнес-фичи (`car_age`, `power_per_engine`, `km_per_year`).
- Изучили данные: распределения, пропуски, корреляции (Pearson/Spearman), ANOVA по категориям, Cramer’s V, pairplot на сэмпле.
- Обучили линейные модели (Ridge/ElasticNet/Lasso/0L(omp)) на числовых и числовых+категориальных (OHE). Лучшая - это Ridge с числовыми, стандартизированными, плюс OHE категорий.
- Проверили модели на бизнес метриках, где выиграла Lasso.
- Собрали sklearn-пайплайн (лучшей модели в файл в train_model.py), сохранили артефакт `/artifacts/model_bundle.pkl`. 
- Реализовали Streamlit-апп: вкладки EDA, инференс, визуализация весов модели. EDA работает на тех же преобразованных фичах, что и модель, для наглядности данных. (не считая пропуски)

## Результаты (метрики)
- Базовый пайплайн (скейлим только числовые): R2 train/test = 0.954 / 0.933, MSE train/test = 30.3e9 / 38.3e9. Интерпретация: модель объясняет 93% дисперсии на тесте, средняя квадр. ошибка соответствует 200k–250k в абсолютной цене, что немного учитывая цены на машины.
- Вариант со скейлом категорий после OHE: R2 test = 0.920, MSE test = 46.0e9 — заметно хуже на тесте, не используем (проверял уже не в ноутбук, а когда увидел веса в стримлите).
- Веса Ridge показывают большие сдвиги для дорогих брендов/моделей (это ожидаемо: OHE в рублёвом масштабе, это особенно хорошо видно в визуализации весов).

## Что дало наибольший прирост
- Корректный парсинг числовых текстовых полей и torque (Nm, rpm).
- Стандартизация числовых признаков для линейных моделей.
- OHE - улучшил результат минимум на четверть.
- Добавление простых бизнес-фич (возраст авто, отношение мощности к объёму, км в год).

## Что не удалось / ограничения
- Скейлинг категорий после OHE не улучшил качество, даже немного ухудшил, потому визуализировать веса сложно.
- Категориальные веса остаются крупными по модулю (смещений много), но это оказалось приемлемо для инференса.

## Оценка сервиса
- Удобство: есть загрузка CSV и ручной ввод одного объекта, EDA и веса в отдельных вкладках.
- Визуализация: покрыты ВСЕ распредения, возможность кастомно выбрать пары и подходящие виды графиков, также: корреляции, ANOVA. Для категорий с длинным хвостом сворачиваем в топN, чтобы графики были читаемы. Pairplot выводится на сэмпле, чтобы не подвешивать UI.
- Ограничения/проблемы: большие веса категорий могут смущать при интерпретации,сейчас тяну веса с гита - нужна сеть.
- План улучшений: 
  - добавить кросс-валидацию/подбор `alpha(лямбды)` прямо в пайплайне.
  - вынести инференс на API и кэшировать артефакт локально.
  - добавить лог-скейл для цен на графиках.